<!DOCTYPE HTML>
<html>
<head>
  <title>이슈 상세</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="assets/css/main.css" />
</head>
<body class="is-preload">

  <div id="wrapper">

    <!-- Header -->
    <header id="header">
      <h1><a href="index.html">준혁이는 뉴스 보기 귀찮아!</a></h1>
      <nav class="main">
        <ul>
          <li class="menu"><a class="fa-bars" href="#menu">Menu</a></li>
        </ul>
      </nav>
    </header>

    <!-- Main -->
    <div id="main">
      <article class="post">
        <header>
          <div class="title">
            <h2><span id="post-title">로딩 중…</span></h2>
          </div>
          <div class="meta">
            <time class="published" datetime="" id="post-date">Loading date…</time>
            <a href="#" class="author">
              <span class="name">준혁이</span>
              <img src="images/avatar.jpg" alt="" />
            </a>
          </div>
        </header>

        <p id="post-content">로딩 중…</p>

        <footer>
          <ul class="actions">
            <li><a href="index.html" class="button large">뒤로 가기</a></li>
          </ul>
        </footer>
      </article>
    </div>

    <!-- Sidebar (생략 가능) -->

  </div>

  <!-- 필수 스크립트 -->
  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/browser.min.js"></script>
  <script src="assets/js/breakpoints.min.js"></script>
  <script src="assets/js/util.js"></script>
  <script src="assets/js/main.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const params = new URLSearchParams(window.location.search);
      const issueId = params.get('id');
      if (!issueId) {
        document.getElementById('post-title').textContent = '잘못된 요청입니다.';
        return;
      }

      try {
        const resp = await fetch('https://news-assistant-app-public-1052035590147.us-central1.run.app/api/issues?limit=100&offset=0');
        if (!resp.ok) throw new Error(resp.statusText);
        const issues = await resp.json();

        const issue = issues.find(i => String(i.id) === issueId);
        if (!issue) throw new Error('Not Found');

        document.getElementById('post-title').textContent = issue.issue_name;

        const dateElem = document.getElementById('post-date');
        dateElem.setAttribute('datetime', issue.date);
        dateElem.textContent = new Date(issue.date).toLocaleDateString();

        document.getElementById('post-content').textContent = issue.summary;
      } catch (e) {
        console.error('상세 뉴스 로드 중 에러:', e);
        document.getElementById('post-title').textContent = '상세 뉴스를 불러오는 중 오류가 발생했습니다.';
        document.getElementById('post-content').textContent = e.message;
      }
    });
  </script>

</body>
</html>
